<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0">
  <meta content="yes" name="apple-mobile-web-app-capable" />
  <meta content="black" name="apple-mobile-web-app-status-bar-style" />
  <meta name="format-detection" content="telephone=no" />  
  <link rel="stylesheet" href="http://a.tbcdn.cn/p/global/1.0/global-min.css" />
  <script src="/assets/js/common/console.js"></script>
</head>
<body>
  <style type="text/css">
  .chart{
    width:49%;height:300px;border:1px solid #ccc;float:left;
  }
  .chart-v{
    height: 300px;
  }
  </style>
  <div id="chart" class="chart"></div>
  <!-- <div id="chart2" class="chart"></div> -->
  <div id="chart3" class="chart"></div>
  <div id="chart4" class="chart chart-v"></div>
  <div id="chart5" class="chart chart-v"></div>
</body>
</html>
<script charset="utf-8" src="http://g.tbcdn.cn/kissy/k/1.4.1/seed-min.js"></script>
<script src="/assets/js/gesure/kcharts.js"></script>
<script src="/assets/js/gesure/chart.js"></script>
<script>
KISSY.Config.debug = true;
wss.ready.list.push(function () {
  wss.helper.distance = function (x, y, x2, y2) {
    return Math.sqrt(Math.pow(x2 - x, 2) + Math.pow(y2 - y, 2));
  };
  wss.cmds.gesure = function (dots) {
    renderChart((function (dots) {
      var start = dots.slice(0, 1)[0][0];
      var last = dots.slice(-1)[0][0];
      var record = [];
      var MIN_SPEED = 0.35;
      var MAX_SPEED = 8;
      var startX = start.clientX;
      var startY = start.clientY;
      var len = dots.length;
      var prev;
      if (len < 3) {
        return dots.map(function (dot) {
          dot = dot[0];
          if (dot === start) {
            dot.deltaX = 0;
            dot.deltaY = 0;
          } else {
            dot.deltaX = dot.clientX - start.clientX;
            dot.deltaY = dot.clientY - start.clientY;
          }
          return dot;
        });
      } else {
        return dots.map(function (dot, i) {
          var dot = dot[0];
          if (dot === start) {
            dot.velocity = 0;
            dot.velocityX = 0;
            dot.velocityY = 0;
            dot.deltaX = 0;
            dot.deltaY = 0;
          } else {
            var deltaX = dot.deltaX = dot.clientX - start.clientX;
            var deltaY = dot.deltaY = dot.clientY - start.clientY;
            var duration = dot.timeStamp - prev.timeStamp;
            dot.velocity = wss.helper.distance(deltaX, deltaY, prev.deltaX, prev.deltaY) / duration;
            dot.velocityX = (deltaX - prev.deltaX) /  duration;
            dot.velocityY = (deltaY - prev.deltaY) / duration;
          }
          prev = dot;
          return dot;
        });
      }
    })(dots));
  };
});
</script>