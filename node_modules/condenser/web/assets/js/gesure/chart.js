KISSY.use("kcharts", function(S, KCharts) {
  window.renderChart = function(data) {
    S.all(".chart").html("");

    var series = [{
      data: []
    }];
    var series2 = [{
      data: []
    }];
    var series3 = [{
      data: []
    }];
    var series4 = [{
      data: []
    }];
    var series5 = [{
      data: []
    }];

    var xAxis = [];

    var startTime = 0;
    for (var i in data) {
      if (!startTime) {
        startTime = data[i]['timeStamp'];
      }
      series[0]['data'].push(data[i]['velocity'])
      xAxis.push(data[i]['timeStamp'] - startTime)
      if (i > 0) {
        data[i]['ac'] = (data[i]['velocity'] - data[i - 1]['velocity']) / (data[i]['timeStamp'] - data[i - 1]['timeStamp'])
      } else {
        data[i]['ac'] = 0
      }
      series2[0]['data'].push(data[i]['ac'])

      series3[0]['data'].push([data[i]['deltaX'], -data[i]['deltaY']])

      series4[0]['data'].push(data[i]['velocityX'])

      series5[0]['data'].push(data[i]['velocityY'])

    }

    KCharts.barchart({
      renderTo: "#chart",
      title: {
        content: "速度 px/ms"
      },
      series: series,
      xAxis: {
        text: xAxis
      },
      xLabels:{
        template: function(i, txt) {
            var len = xAxis.length;
            var num = 4;
            if (i % Math.round(len / num) == 0) {
              return txt + " ms";
            }
            return ""
          }
      }
    });

    KCharts.barchart({
      renderTo: "#chart2",
      title: {
        content: "加速度 px/ms^2"
      },
      series: series2,
      xAxis: {
        text: xAxis
      },
      xLabels:{
        template: function(i, txt) {
            var len = xAxis.length;
            var num = 4;
            if (i % Math.round(len / num) == 0) {
              return txt + " ms";
            }
            return ""
          }
      }
    });

    /*轨迹*/
    KCharts.scatterchart({
      renderTo: "#chart3",
      title: {
        content: "手势轨迹"
      },
      series: series3
    });


    //水平方向速度 velocityX
    KCharts.barchart({
      renderTo: "#chart4",
      zoomType:"y",
      title: {
        content: "水平方向速度 px/ms"
      },
      series: series4,
      yAxis: {
        text: xAxis
      },
      xLabels:{
        template: function(i, txt) {
            var len = xAxis.length;
            var num = 4;
            if (i % Math.round(len / num) == 0) {
              return txt + " px/ms";
            }
            return ""
          }
      }
    });


    //垂直方向速度 velocityY
    KCharts.barchart({
      renderTo: "#chart5",
      title: {
        content: "垂直方向速度 px/ms"
      },
      series: series5,
      xAxis: {
        text: xAxis
      },
      yLabels:{
        template: function(i, txt) {
            return txt + "px/ms"
          }
      },
      xLabels:{
        template: function(i, txt) {
            var len = xAxis.length;
            var num = 4;
            if (i % Math.round(len / num) == 0) {
              return txt + " ms";
            }
            return ""
          }
      }
    });

  }

});